# ==============================================
# OPTIMUS-LMS PLATFORM - ENVIRONMENT VARIABLES
# ==============================================
# Author: LIMAME Ghassene
# Copy this file to .env and configure with your values

# ==============================================
# REQUIRED FOR PRODUCTION
# ==============================================

# Port Configuration
PORT=5000

# Node Environment (development | production | test)
NODE_ENV=production

# Database Configuration (REQUIRED)
# PostgreSQL connection URL
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://user:password@host:5432/optimus_lms

# Authentication Configuration (REQUIRED)
# Your deployed domain(s) - comma-separated list
# Example: REPLIT_DOMAINS=yourapp.replit.app,custom-domain.com
REPLIT_DOMAINS=yourapp.replit.app

# Session Security (REQUIRED - Generate with: openssl rand -base64 32)
SESSION_SECRET=

# Public Domain Configuration (REQUIRED for SCORM exports)
# MUST match your deployed URL for external LMS integration
# Example: https://yourapp.replit.app OR https://yourdomain.com
PUBLIC_DOMAIN=https://yourapp.replit.app

# Replit OIDC (auto-configured by Replit)
ISSUER_URL=https://replit.com/oidc
REPL_ID=

# ==============================================
# REDIS CLOUD CONFIGURATION (RECOMMENDED)
# ==============================================
# For production-grade caching and session management
# Sign up: https://redis.com/try-free/

# Redis Connection
REDIS_HOST=your-redis-host.cloud.redislabs.com
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_USERNAME=default

# Cache TTL Settings (seconds)
CACHE_TTL_DEFAULT=300
CACHE_TTL_SESSION=3600
CACHE_TTL_COURSES=600
CACHE_TTL_TENANTS=3600
CACHE_TTL_MANIFESTS=3600

# ==============================================
# STORAGE & CDN CONFIGURATION
# ==============================================

# Storage Provider (local | cloudflare-r2 | s3-cloudfront)
STORAGE_PROVIDER=local

# Local Storage (default - no configuration needed)
UPLOADS_DIR=./uploads

# ==============================================
# CLOUDFLARE R2 CDN (RECOMMENDED FOR GLOBAL CDN)
# ==============================================
# CloudFlare R2: S3-compatible storage with free egress
# Setup: https://www.cloudflare.com/products/r2/

# CloudFlare Account & R2 Configuration
CLOUDFLARE_ACCOUNT_ID=
CLOUDFLARE_R2_ACCESS_KEY_ID=
CLOUDFLARE_R2_SECRET_ACCESS_KEY=
CLOUDFLARE_R2_BUCKET_NAME=optimus-lms-courses
CLOUDFLARE_R2_CDN_DOMAIN=cdn.yourdomain.com

# CloudFlare Cache Purging (optional)
CLOUDFLARE_ZONE_ID=
CLOUDFLARE_API_TOKEN=

# ==============================================
# AWS S3 + CLOUDFRONT (ALTERNATIVE CDN)
# ==============================================
# AWS Configuration (if using S3 + CloudFront instead of R2)

AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET_NAME=optimus-lms-courses
AWS_CLOUDFRONT_DOMAIN=d123456789.cloudfront.net
AWS_CLOUDFRONT_DISTRIBUTION_ID=E123456789ABCD

# ==============================================
# SECURITY & ENCRYPTION
# ==============================================

# Field-level Encryption (auto-generated if not set)
# For production: openssl rand -hex 32
ENCRYPTION_KEY=

# Rate Limiting (defaults configured in code)
RATE_LIMIT_AUTH_ATTEMPTS=5
RATE_LIMIT_AUTH_WINDOW=900000
RATE_LIMIT_UPLOAD_MAX=20
RATE_LIMIT_UPLOAD_WINDOW=3600000

# ==============================================
# MONITORING & LOGGING
# ==============================================

# Log Level (error | warn | info | debug)
LOG_LEVEL=info

# Audit Logging
ENABLE_AUDIT_LOG=true

# ==============================================
# FEATURE FLAGS
# ==============================================

# Enable/Disable Features
ENABLE_CDN=false
ENABLE_XAPI_TRACKING=true
ENABLE_LICENSE_ENFORCEMENT=true

# ==============================================
# DEVELOPMENT SETTINGS (DEV ONLY)
# ==============================================

# Development Mode
# NODE_ENV=development

# Development Database (optional)
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sunscorm_dev

# Development Redis (optional - local instance)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=

# ==============================================
# CONFIGURATION CHECKLIST
# ==============================================
#
# âœ… MINIMAL SETUP (Local Development):
# 1. Copy this file to .env
# 2. Set DATABASE_URL (PostgreSQL)
# 3. Generate SESSION_SECRET
# 4. Set PUBLIC_DOMAIN
# 5. Run: pnpm install && pnpm run db:push && pnpm run dev
#
# ðŸš€ PRODUCTION SETUP (Recommended):
# 1. Complete minimal setup above
# 2. Configure Redis Cloud (REDIS_HOST, REDIS_PORT, REDIS_PASSWORD)
# 3. Configure CloudFlare R2 or AWS S3 for global CDN
# 4. Generate ENCRYPTION_KEY for field-level encryption
# 5. Update REPLIT_DOMAINS with production domains
# 6. Set LOG_LEVEL=warn or error
# 7. Run: pnpm run build && pnpm run start
#
# ðŸ“š DOCUMENTATION:
# - Redis Setup: REDIS_CACHING.md
# - CDN Configuration: CDN_INTEGRATION.md
# - Security Guide: SECURITY.md
# - Testing: TESTING.md
# - Migration: PNPM_MIGRATION.md
#
# ðŸ”— RESOURCES:
# - Redis Cloud: https://redis.com/try-free/
# - CloudFlare R2: https://www.cloudflare.com/products/r2/
# - AWS CloudFront: https://aws.amazon.com/cloudfront/
# - Generate Secrets: openssl rand -base64 32