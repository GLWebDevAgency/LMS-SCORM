# ==============================================
# OPTIMUS-LMS PLATFORM - TEST ENVIRONMENT
# ==============================================
# Author: LIMAME Ghassene
# Configuration for automated testing (Vitest, Playwright)

# Port Configuration
PORT=5000

# Node Environment
NODE_ENV=test

# ==============================================
# DATABASE CONFIGURATION (TEST)
# ==============================================

# Test Database (isolated from development)
# Create with: createdb optimus_lms_test
DATABASE_URL=postgresql://postgres:test@localhost:5432/optimus_lms_test

# ==============================================
# AUTHENTICATION & SECURITY (TEST)
# ==============================================

# Test-only credentials (NOT secure)
SESSION_SECRET=test-secret-key-for-testing-only-not-secure
PUBLIC_DOMAIN=http://localhost:5000
REPLIT_DOMAINS=localhost:5000

# Mock OIDC
ISSUER_URL=https://replit.com/oidc
REPL_ID=test-repl-id

# ==============================================
# REDIS CONFIGURATION (TEST)
# ==============================================

# Option 1: Disable Redis for faster tests (use in-memory fallback)
# REDIS_HOST=
# REDIS_PORT=
# REDIS_PASSWORD=

# Option 2: Use test Redis instance (if available)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Short TTL for tests
CACHE_TTL_DEFAULT=10
CACHE_TTL_SESSION=60
CACHE_TTL_COURSES=30
CACHE_TTL_TENANTS=60
CACHE_TTL_MANIFESTS=30

# ==============================================
# STORAGE CONFIGURATION (TEST)
# ==============================================

# Test storage (temporary directory)
STORAGE_PROVIDER=local
UPLOADS_DIR=./test-uploads

# ==============================================
# TEST FEATURES
# ==============================================

# Disable External Services
DISABLE_EXTERNAL_SERVICES=true

# Verbose logging for debugging test failures
LOG_LEVEL=error

# Audit logging (optional in tests)
ENABLE_AUDIT_LOG=false

# Feature Flags (all enabled for comprehensive testing)
ENABLE_CDN=false
ENABLE_XAPI_TRACKING=true
ENABLE_LICENSE_ENFORCEMENT=true

# ==============================================
# TEST-SPECIFIC CONFIGURATION
# ==============================================

# Test timeout (milliseconds)
TEST_TIMEOUT=30000

# Disable rate limiting in tests
DISABLE_RATE_LIMITING=true

# Mock external APIs
MOCK_EXTERNAL_APIS=true

# ==============================================
# NOTES
# ==============================================
#
# üìã TEST SETUP:
# 1. Create test database: createdb optimus_lms_test
# 2. (Optional) Start local Redis: redis-server
# 3. Run migrations: DATABASE_URL="postgresql://postgres:test@localhost:5432/optimus_lms_test" pnpm run db:push
# 4. Run tests: pnpm test
#
# üß™ TEST COMMANDS:
# - All tests: pnpm test
# - Unit tests: pnpm run test:unit
# - Integration: pnpm run test:integration
# - E2E: pnpm run test:e2e
# - Coverage: pnpm run test:coverage
#
# üîç CI/CD:
# This file is used automatically in GitHub Actions
# Database and services are configured via CI workflow
#
# ‚ö†Ô∏è IMPORTANT:
# - Never commit sensitive credentials to this file
# - Test database is wiped between test runs
# - Test uploads directory is temporary

